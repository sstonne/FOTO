<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>FÅŒTÅŒ â€” ì‚¬ì§„ ê³µìœ </title>
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0c0c0c;
    --surface: #161616;
    --surface2: #1f1f1f;
    --border: #2a2a2a;
    --accent: #e8d5b0;
    --accent2: #c9a96e;
    --text: #f0ece4;
    --text-dim: #8a8680;
    --danger: #e07070;
    --success: #7ec899;
    --radius: 12px;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    min-height: 100vh;
    line-height: 1.6;
    overflow-x: hidden;
  }

  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 0;
    opacity: 0.6;
  }

  .wrap { position: relative; z-index: 1; max-width: 960px; margin: 0 auto; padding: 0 20px; }

  /* â”€â”€â”€ HEADER â”€â”€â”€ */
  header { border-bottom: 1px solid var(--border); padding: 16px 0; }
  header .wrap { display: flex; align-items: center; justify-content: space-between; }
  .logo { font-family: 'DM Serif Display', serif; font-size: 1.5rem; letter-spacing: 0.12em; color: var(--accent); cursor: pointer; }
  .logo span { font-style: italic; color: var(--accent2); }
  .header-sub { font-size: 0.72rem; color: var(--text-dim); letter-spacing: 0.05em; }

  /* â”€â”€â”€ HOME PAGE â”€â”€â”€ */
  #page-home { padding: 48px 0 60px; }

  .hero-title {
    font-family: 'DM Serif Display', serif;
    font-size: clamp(2rem, 6vw, 4rem);
    line-height: 1.1;
    margin-bottom: 14px;
  }
  .hero-title em { font-style: italic; color: var(--accent2); }
  .hero-sub { font-size: 0.95rem; color: var(--text-dim); max-width: 480px; margin-bottom: 36px; font-weight: 300; }

  /* â”€â”€â”€ UPLOAD CARD â”€â”€â”€ */
  .upload-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden; }
  .upload-card-header { padding: 16px 20px; border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 10px; }
  .step-badge { width: 24px; height: 24px; background: var(--accent); color: var(--bg); border-radius: 50%; font-size: 0.7rem; font-weight: 500; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
  .upload-card-title { font-size: 0.9rem; font-weight: 500; }
  .upload-card-body { padding: 20px; }

  .field { margin-bottom: 18px; }
  .field label { display: block; font-size: 0.75rem; color: var(--text-dim); letter-spacing: 0.04em; margin-bottom: 7px; text-transform: uppercase; }
  .field input[type="text"] {
    width: 100%; background: var(--surface2); border: 1px solid var(--border);
    border-radius: 8px; padding: 12px 14px; color: var(--text);
    font-family: 'DM Sans', sans-serif; font-size: 1rem; outline: none;
    transition: border-color 0.2s; -webkit-appearance: none;
  }
  .field input[type="text"]:focus { border-color: var(--accent2); }
  .field input[type="text"]::placeholder { color: var(--text-dim); opacity: 0.6; }

  /* Drop zone */
  #drop-zone {
    border: 2px dashed var(--border); border-radius: var(--radius);
    padding: 36px 20px; text-align: center; cursor: pointer;
    transition: all 0.2s; background: var(--bg); position: relative; user-select: none;
  }
  #drop-zone:hover, #drop-zone.drag-over { border-color: var(--accent2); background: rgba(201,169,110,0.04); }
  #drop-zone input { display: none; }
  .drop-icon { font-size: 2.2rem; margin-bottom: 10px; opacity: 0.7; }
  .drop-text { font-size: 0.9rem; color: var(--text-dim); }
  .drop-text strong { color: var(--accent); font-weight: 500; }
  .drop-hint { font-size: 0.75rem; color: var(--text-dim); margin-top: 5px; opacity: 0.6; }

  /* Preview grid */
  #preview-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(90px, 1fr)); gap: 8px; margin-top: 16px; }
  .preview-item { position: relative; aspect-ratio: 1; border-radius: 8px; overflow: hidden; background: var(--surface2); }
  .preview-item img { width: 100%; height: 100%; object-fit: cover; display: block; }
  .preview-remove {
    position: absolute; top: 4px; right: 4px; width: 24px; height: 24px;
    background: rgba(0,0,0,0.75); border: none; border-radius: 50%;
    color: white; font-size: 0.8rem; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
  }
  .preview-name { position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, rgba(0,0,0,0.7)); color: white; font-size: 0.58rem; padding: 8px 4px 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

  /* Buttons */
  .btn-primary {
    display: inline-flex; align-items: center; gap: 8px;
    background: var(--accent); color: var(--bg); border: none; border-radius: 8px;
    padding: 13px 24px; font-family: 'DM Sans', sans-serif; font-size: 0.9rem;
    font-weight: 500; cursor: pointer; transition: all 0.2s; letter-spacing: 0.02em;
    -webkit-appearance: none;
  }
  .btn-primary:hover { background: var(--accent2); }
  .btn-primary:active { transform: scale(0.97); }
  .btn-primary:disabled { opacity: 0.4; cursor: not-allowed; }
  .btn-secondary {
    display: inline-flex; align-items: center; gap: 8px;
    background: transparent; color: var(--text); border: 1px solid var(--border);
    border-radius: 8px; padding: 12px 20px; font-family: 'DM Sans', sans-serif;
    font-size: 0.88rem; cursor: pointer; transition: all 0.2s; -webkit-appearance: none;
  }
  .btn-secondary:hover { border-color: var(--accent2); color: var(--accent); }
  .btn-secondary:active { transform: scale(0.97); }

  .upload-actions { display: flex; align-items: center; justify-content: space-between; margin-top: 18px; flex-wrap: wrap; gap: 10px; }
  .file-count { font-size: 0.82rem; color: var(--text-dim); }

  /* Progress */
  #progress-bar-wrap { background: var(--surface2); border-radius: 100px; height: 4px; overflow: hidden; margin-top: 14px; display: none; }
  #progress-bar { height: 100%; background: var(--accent2); border-radius: 100px; width: 0%; transition: width 0.3s; }
  #progress-text { font-size: 0.8rem; color: var(--text-dim); margin-top: 8px; display: none; text-align: center; }

  /* Link result */
  #link-result { margin-top: 20px; background: rgba(126,200,153,0.08); border: 1px solid rgba(126,200,153,0.2); border-radius: var(--radius); padding: 18px 20px; display: none; }
  .link-result-label { font-size: 0.75rem; color: var(--success); text-transform: uppercase; letter-spacing: 0.06em; margin-bottom: 10px; }
  .link-box { display: flex; gap: 8px; align-items: center; }
  .link-box input { flex: 1; min-width: 0; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; padding: 10px 12px; color: var(--text); font-family: 'DM Sans', sans-serif; font-size: 0.82rem; outline: none; }
  .btn-copy { background: var(--success); color: var(--bg); border: none; border-radius: 8px; padding: 10px 16px; font-family: 'DM Sans', sans-serif; font-size: 0.85rem; font-weight: 500; cursor: pointer; transition: all 0.2s; white-space: nowrap; flex-shrink: 0; }
  .btn-copy:active { transform: scale(0.97); }
  .btn-copy.copied { background: var(--accent2); }
  .link-note { font-size: 0.76rem; color: var(--text-dim); margin-top: 8px; }

  /* How it works */
  .how-section { margin-top: 48px; padding-top: 36px; border-top: 1px solid var(--border); }
  .how-title { font-family: 'DM Serif Display', serif; font-size: 1.3rem; margin-bottom: 20px; color: var(--accent); }
  .how-steps { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 12px; }
  .how-step { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius); padding: 18px; }
  .how-step-num { font-size: 1.6rem; font-family: 'DM Serif Display', serif; color: var(--border); margin-bottom: 6px; }
  .how-step-title { font-size: 0.85rem; font-weight: 500; color: var(--accent); margin-bottom: 5px; }
  .how-step-desc { font-size: 0.78rem; color: var(--text-dim); line-height: 1.5; }

  /* â”€â”€â”€ ALBUM PAGE â”€â”€â”€ */
  #page-album { padding: 36px 0 80px; display: none; }
  .album-back { display: inline-flex; align-items: center; gap: 6px; font-size: 0.82rem; color: var(--text-dim); cursor: pointer; margin-bottom: 18px; transition: color 0.2s; border: none; background: none; font-family: 'DM Sans', sans-serif; padding: 4px 0; }
  .album-back:hover { color: var(--accent); }
  .album-title { font-family: 'DM Serif Display', serif; font-size: clamp(1.6rem, 5vw, 2.8rem); margin-bottom: 6px; }
  .album-meta { font-size: 0.82rem; color: var(--text-dim); }
  .album-meta span { color: var(--accent2); }
  .album-actions { display: flex; gap: 8px; margin-top: 16px; flex-wrap: wrap; }

  /* â”€â”€â”€ PHOTO GRID â”€â”€â”€ */
  #album-grid { columns: 3 200px; gap: 8px; margin-top: 28px; }
  .photo-card { break-inside: avoid; margin-bottom: 8px; border-radius: 10px; overflow: hidden; position: relative; background: var(--surface); }
  .photo-card img { width: 100%; display: block; transition: transform 0.3s; }
  .photo-card:hover img { transform: scale(1.03); }

  /* ë°ìŠ¤í¬íƒ‘: hover overlay */
  .photo-overlay {
    position: absolute; inset: 0;
    background: linear-gradient(transparent 45%, rgba(0,0,0,0.75));
    opacity: 0; transition: opacity 0.2s;
    display: flex; align-items: flex-end; padding: 10px; gap: 6px; flex-wrap: wrap;
  }
  .photo-card:hover .photo-overlay { opacity: 1; }

  /* ëª¨ë°”ì¼: í•­ìƒ ë³´ì´ëŠ” í•˜ë‹¨ ë²„íŠ¼ë°” */
  .photo-mobile-bar {
    display: none;
    background: linear-gradient(transparent, rgba(0,0,0,0.65));
    position: absolute; bottom: 0; left: 0; right: 0;
    padding: 20px 8px 8px;
    gap: 6px;
    flex-wrap: wrap;
  }

  .photo-overlay-btn {
    background: rgba(255,255,255,0.15); backdrop-filter: blur(8px);
    border: 1px solid rgba(255,255,255,0.2); color: white; border-radius: 6px;
    padding: 6px 10px; font-size: 0.75rem; cursor: pointer;
    font-family: 'DM Sans', sans-serif; transition: background 0.15s;
    display: inline-flex; align-items: center; gap: 4px;
    -webkit-appearance: none; white-space: nowrap;
  }
  .photo-overlay-btn:active { background: rgba(255,255,255,0.3); }

  /* â”€â”€â”€ LIGHTBOX â”€â”€â”€ */
  #lightbox {
    display: none; position: fixed; inset: 0;
    background: rgba(0,0,0,0.97); z-index: 100;
    align-items: center; justify-content: center; flex-direction: column;
    padding: 60px 16px 20px;
  }
  #lightbox.open { display: flex; }
  #lightbox-img-wrap { flex: 1; display: flex; align-items: center; justify-content: center; width: 100%; overflow: hidden; }
  #lightbox img { max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 6px; touch-action: pinch-zoom; }
  .lightbox-close { position: absolute; top: 16px; right: 16px; background: rgba(255,255,255,0.1); border: 1px solid var(--border); color: var(--text); border-radius: 50%; width: 40px; height: 40px; font-size: 1rem; cursor: pointer; display: flex; align-items: center; justify-content: center; z-index: 10; }
  .lightbox-close:active { background: rgba(255,255,255,0.2); }
  .lightbox-bottom { display: flex; align-items: center; gap: 12px; padding-top: 14px; flex-wrap: wrap; justify-content: center; flex-shrink: 0; }
  .lightbox-name { font-size: 0.8rem; color: var(--text-dim); text-align: center; }
  .lightbox-nav { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.08); border: 1px solid var(--border); color: var(--text); border-radius: 8px; width: 44px; height: 44px; font-size: 1.2rem; cursor: pointer; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(8px); z-index: 10; }
  .lightbox-nav:active { background: rgba(255,255,255,0.18); }
  #lb-prev { left: 12px; }
  #lb-next { right: 12px; }

  /* ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ - ë¼ì´íŠ¸ë°•ìŠ¤ */
  .lb-dl-btn { background: var(--accent2); color: var(--bg); border: none; border-radius: 8px; padding: 10px 20px; font-family: 'DM Sans', sans-serif; font-size: 0.88rem; font-weight: 500; cursor: pointer; display: inline-flex; align-items: center; gap: 6px; transition: opacity 0.2s; }
  .lb-dl-btn:active { opacity: 0.8; }

  /* â”€â”€â”€ LOADING â”€â”€â”€ */
  .loading-spinner { width: 32px; height: 32px; border: 2px solid var(--border); border-top-color: var(--accent2); border-radius: 50%; animation: spin 0.7s linear infinite; margin: 60px auto; display: none; }
  @keyframes spin { to { transform: rotate(360deg); } }

  /* â”€â”€â”€ TOAST â”€â”€â”€ */
  #toast {
    position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%) translateY(80px);
    background: var(--surface2); border: 1px solid var(--border); border-radius: 100px;
    padding: 10px 20px; font-size: 0.85rem; color: var(--text); z-index: 300;
    transition: transform 0.3s cubic-bezier(0.34,1.56,0.64,1); white-space: nowrap;
    max-width: calc(100vw - 40px); text-align: center;
  }
  #toast.show { transform: translateX(-50%) translateY(0); }
  #toast.success { border-color: rgba(126,200,153,0.4); color: var(--success); }
  #toast.error { border-color: rgba(224,112,112,0.4); color: var(--danger); }

  /* â”€â”€â”€ ERROR â”€â”€â”€ */
  .error-state { text-align: center; padding: 60px 20px; }
  .error-state h2 { font-family: 'DM Serif Display', serif; font-size: 1.5rem; margin-bottom: 10px; }
  .error-state p { color: var(--text-dim); margin-bottom: 20px; font-size: 0.9rem; }

  /* â”€â”€â”€ FOOTER â”€â”€â”€ */
  footer { border-top: 1px solid var(--border); padding: 20px 0; margin-top: 40px; }
  footer .wrap { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 6px; }
  .footer-note { font-size: 0.72rem; color: var(--text-dim); }

  /* â”€â”€â”€ API KEY MODAL â”€â”€â”€ */
  #api-modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 300; align-items: center; justify-content: center; padding: 20px; }
  #api-modal.open { display: flex; }
  .api-modal-box { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius); padding: 28px 24px; max-width: 460px; width: 100%; max-height: 90vh; overflow-y: auto; }
  .api-modal-title { font-family: 'DM Serif Display', serif; font-size: 1.3rem; margin-bottom: 8px; color: var(--accent); }
  .api-modal-desc { font-size: 0.83rem; color: var(--text-dim); margin-bottom: 20px; line-height: 1.6; }
  .api-modal-desc a { color: var(--accent2); text-decoration: none; }
  .api-modal-steps { background: var(--bg); border-radius: 8px; padding: 14px; margin-bottom: 18px; }
  .api-modal-step { font-size: 0.8rem; color: var(--text-dim); padding: 4px 0; display: flex; gap: 10px; }
  .api-modal-step-num { color: var(--accent2); font-weight: 500; flex-shrink: 0; }
  .api-modal-actions { display: flex; gap: 10px; margin-top: 18px; flex-wrap: wrap; }

  /* â”€â”€â”€ RESPONSIVE â”€â”€â”€ */
  @media (max-width: 600px) {
    #album-grid { columns: 2 140px; gap: 6px; }
    #album-grid .photo-card { margin-bottom: 6px; }
    .lightbox-nav { display: none; }
    .photo-overlay { display: none !important; }
    .photo-mobile-bar { display: flex; }
    .how-steps { grid-template-columns: 1fr 1fr; }
    .album-actions { gap: 6px; }
    .album-actions .btn-primary,
    .album-actions .btn-secondary { padding: 10px 14px; font-size: 0.82rem; }
    #page-home { padding: 32px 0 48px; }
    .upload-card-body { padding: 16px; }
  }

  @media (max-width: 380px) {
    #album-grid { columns: 2 120px; }
    .hero-title { font-size: 1.8rem; }
  }

  /* Animations */
  .fade-in { animation: fadeIn 0.35s ease; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>
<body>

<header>
  <div class="wrap">
    <div class="logo" onclick="showHome()">FÅŒ<span>TÅŒ</span></div>
    <div class="header-sub">ë¬´ë£Œ ì‚¬ì§„ ê³µìœ </div>
  </div>
</header>

<!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ HOME PAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div id="page-home">
  <div class="wrap">
    <h1 class="hero-title">ì‚¬ì§„ì„ ì˜¬ë¦¬ê³ <br><em>ë§í¬ í•˜ë‚˜</em>ë¡œ ê³µìœ í•˜ì„¸ìš”</h1>
    <p class="hero-sub">íšŒì›ê°€ì… ì—†ì´ ì‚¬ì§„ì„ ì—…ë¡œë“œí•˜ê³ , ë§í¬ í•˜ë‚˜ë¡œ ëˆ„êµ¬ì—ê²Œë‚˜ ê³µìœ í•˜ì„¸ìš”. ë°›ëŠ” ì‚¬ëŒì€ ì—´ëŒê³¼ ì›ë³¸ ë‹¤ìš´ë¡œë“œê°€ ëª¨ë‘ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>

    <div class="upload-card fade-in">
      <div class="upload-card-header">
        <div class="step-badge">1</div>
        <div class="upload-card-title">ì•¨ë²” ë§Œë“¤ê¸°</div>
      </div>
      <div class="upload-card-body">
        <!-- ImgBB API Key ì•ˆë‚´ -->
        <div id="api-notice" style="background:rgba(232,213,176,0.08);border:1px solid rgba(232,213,176,0.15);border-radius:8px;padding:12px 14px;margin-bottom:16px;font-size:0.8rem;color:var(--text-dim);line-height:1.5;">
          ğŸ“Œ <strong style="color:var(--accent)">ImgBB API í‚¤</strong>ê°€ í•„ìš”í•©ë‹ˆë‹¤.
          <a href="https://api.imgbb.com/" target="_blank" style="color:var(--accent2)">api.imgbb.com</a>ì—ì„œ ë¬´ë£Œ ë°œê¸‰ í›„ ì…ë ¥í•˜ì„¸ìš”.
          <button onclick="showApiModal()" style="margin-left:6px;background:var(--accent2);color:var(--bg);border:none;border-radius:4px;padding:3px 10px;font-size:0.76rem;cursor:pointer;font-family:'DM Sans',sans-serif;">í‚¤ ì…ë ¥</button>
          <span id="api-status" style="margin-left:6px;"></span>
        </div>

        <div class="field">
          <label>ì•¨ë²” ì´ë¦„</label>
          <input type="text" id="album-title-input" placeholder="ì˜ˆ: ì œì£¼ë„ ì—¬í–‰ 2024" maxlength="80">
        </div>

        <div id="drop-zone">
          <input type="file" id="file-input" multiple accept="image/*">
          <div class="drop-icon">ğŸ–¼ï¸</div>
          <div class="drop-text"><strong>í´ë¦­í•˜ê±°ë‚˜ ë“œë˜ê·¸</strong>í•´ì„œ ì‚¬ì§„ ì¶”ê°€</div>
          <div class="drop-hint">JPG, PNG, WEBP, GIF Â· ìµœëŒ€ 32MB / ì¥</div>
        </div>

        <div id="preview-grid"></div>
        <div id="progress-bar-wrap"><div id="progress-bar"></div></div>
        <div id="progress-text"></div>

        <div class="upload-actions">
          <div class="file-count" id="file-count">ì„ íƒëœ íŒŒì¼ ì—†ìŒ</div>
          <button class="btn-primary" id="upload-btn" onclick="startUpload()" disabled>
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
            ì•¨ë²” ìƒì„±í•˜ê¸°
          </button>
        </div>

        <div id="link-result">
          <div class="link-result-label">âœ“ ì•¨ë²”ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤</div>
          <div class="link-box">
            <input type="text" id="link-input" readonly>
            <button class="btn-copy" id="copy-btn" onclick="copyLink()">ë³µì‚¬</button>
          </div>
          <div class="link-note">ì´ ë§í¬ë¥¼ ê³µìœ í•˜ë©´ ëˆ„êµ¬ë‚˜ ì‚¬ì§„ì„ ì—´ëŒí•˜ê³  ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
          <div style="margin-top:12px;">
            <button class="btn-secondary" onclick="goToCurrentAlbum()">ì•¨ë²” ë³´ê¸° â†’</button>
          </div>
        </div>
      </div>
    </div>

    <div class="how-section">
      <div class="how-title">ì‚¬ìš© ë°©ë²•</div>
      <div class="how-steps">
        <div class="how-step"><div class="how-step-num">01</div><div class="how-step-title">ì‚¬ì§„ ì—…ë¡œë“œ</div><div class="how-step-desc">í´ë¦­í•˜ê±°ë‚˜ ë“œë˜ê·¸í•´ì„œ ì„ íƒ. ì—¬ëŸ¬ ì¥ í•œ ë²ˆì— ê°€ëŠ¥.</div></div>
        <div class="how-step"><div class="how-step-num">02</div><div class="how-step-title">ë§í¬ ìƒì„±</div><div class="how-step-desc">ì—…ë¡œë“œ ì™„ë£Œ í›„ ì§§ì€ ê³µìœ  ë§í¬ê°€ ìë™ ìƒì„±ë©ë‹ˆë‹¤.</div></div>
        <div class="how-step"><div class="how-step-num">03</div><div class="how-step-title">ê³µìœ í•˜ê¸°</div><div class="how-step-desc">ë§í¬ë¥¼ ì¹´í†¡, ë¬¸ì, SNS ì–´ë””ë“  ê³µìœ í•˜ì„¸ìš”.</div></div>
        <div class="how-step"><div class="how-step-num">04</div><div class="how-step-title">ì—´ëŒ Â· ë‹¤ìš´ë¡œë“œ</div><div class="how-step-desc">ë°›ëŠ” ì‚¬ëŒì€ ë¡œê·¸ì¸ ì—†ì´ ë³´ê¸°ì™€ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥.</div></div>
      </div>
    </div>
  </div>
</div>

<!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ALBUM PAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div id="page-album">
  <div class="wrap">
    <div class="album-header">
      <button class="album-back" onclick="showHome()">â† í™ˆìœ¼ë¡œ</button>
      <h1 class="album-title" id="album-display-title">ì•¨ë²”</h1>
      <div class="album-meta"><span id="album-photo-count">0</span>ì¥ì˜ ì‚¬ì§„</div>
      <div class="album-actions">
        <button class="btn-secondary" onclick="shareAlbum()">
          <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/></svg>
          ë§í¬ ë³µì‚¬
        </button>
        <button class="btn-primary" onclick="downloadAll()">
          <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
          ì „ì²´ ë‹¤ìš´ë¡œë“œ
        </button>
      </div>
    </div>

    <div class="loading-spinner" id="album-loader"></div>
    <div id="album-grid"></div>
    <div id="album-error" class="error-state" style="display:none">
      <h2>ì•¨ë²”ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</h2>
      <p>ë§í¬ê°€ ë§Œë£Œë˜ì—ˆê±°ë‚˜ ì˜ëª»ëœ ë§í¬ì…ë‹ˆë‹¤.</p>
      <button class="btn-primary" onclick="showHome()">í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
    </div>
  </div>
</div>

<!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ LIGHTBOX â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div id="lightbox">
  <button class="lightbox-close" onclick="closeLightbox()">âœ•</button>
  <button class="lightbox-nav" id="lb-prev" onclick="lightboxNav(-1)">â€¹</button>
  <button class="lightbox-nav" id="lb-next" onclick="lightboxNav(1)">â€º</button>
  <div id="lightbox-img-wrap">
    <img id="lightbox-img" src="" alt="">
  </div>
  <div class="lightbox-bottom">
    <div class="lightbox-name" id="lightbox-name"></div>
    <button class="lb-dl-btn" onclick="downloadCurrent()">
      <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
      ì›ë³¸ ë‹¤ìš´ë¡œë“œ
    </button>
  </div>
</div>

<!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ API KEY MODAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div id="api-modal">
  <div class="api-modal-box">
    <div class="api-modal-title">ImgBB API í‚¤ ì„¤ì •</div>
    <div class="api-modal-desc">
      ImgBB ë¬´ë£Œ ê³„ì •ì—ì„œ API í‚¤ë¥¼ ë°œê¸‰ë°›ìœ¼ì„¸ìš”.<br>
      <a href="https://imgbb.com/signup" target="_blank">imgbb.com/signup</a> ê°€ì… í›„
      <a href="https://api.imgbb.com/" target="_blank">api.imgbb.com</a>ì—ì„œ ë°œê¸‰ ê°€ëŠ¥í•©ë‹ˆë‹¤.
    </div>
    <div class="api-modal-steps">
      <div class="api-modal-step"><span class="api-modal-step-num">1.</span><span><a href="https://imgbb.com/signup" target="_blank" style="color:var(--accent2)">imgbb.com/signup</a> ì—ì„œ ë¬´ë£Œ ê°€ì…</span></div>
      <div class="api-modal-step"><span class="api-modal-step-num">2.</span><span><a href="https://api.imgbb.com/" target="_blank" style="color:var(--accent2)">api.imgbb.com</a> â†’ "Get API key" í´ë¦­</span></div>
      <div class="api-modal-step"><span class="api-modal-step-num">3.</span><span>ë°œê¸‰ëœ í‚¤ë¥¼ ì•„ë˜ì— ë¶™ì—¬ë„£ê¸°</span></div>
    </div>
    <div class="field">
      <label>API í‚¤</label>
      <input type="text" id="api-key-input" placeholder="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx">
    </div>
    <div class="api-modal-actions">
      <button class="btn-primary" onclick="saveApiKey()">ì €ì¥í•˜ê¸°</button>
      <button class="btn-secondary" onclick="closeApiModal()">ì·¨ì†Œ</button>
    </div>
  </div>
</div>

<div id="toast"></div>

<footer>
  <div class="wrap">
    <div class="footer-note">FÅŒTÅŒ Â· ë¬´ë£Œ ì‚¬ì§„ ê³µìœ </div>
    <div class="footer-note">Powered by ImgBB + Supabase</div>
  </div>
</footer>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CONFIG â€” Supabase (ì‚¬ìš©ì ì„¤ì • ë¶ˆí•„ìš”)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const SUPABASE_URL = 'https://xtffznxpjuweqxzshjmq.supabase.co';
const SUPABASE_ANON_KEY = 'sb_publishable_4MmABUR-K36eL-_Qek30BA_yEjxCUPh';

// Supabase REST API í—¬í¼
const sb = {
  async insert(table, data) {
    const res = await fetch(`${SUPABASE_URL}/rest/v1/${table}`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'apikey': SUPABASE_ANON_KEY,
        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
        'Prefer': 'return=representation'
      },
      body: JSON.stringify(data)
    });
    if (!res.ok) throw new Error(await res.text());
    return res.json();
  },
  async select(table, id) {
    const res = await fetch(`${SUPABASE_URL}/rest/v1/${table}?id=eq.${id}&select=*`, {
      headers: {
        'apikey': SUPABASE_ANON_KEY,
        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
      }
    });
    if (!res.ok) throw new Error(await res.text());
    const rows = await res.json();
    return rows[0] || null;
  }
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let selectedFiles = [];
let currentAlbumId = null;
let currentAlbumPhotos = [];
let lightboxIndex = 0;
let IMGBB_API_KEY = localStorage.getItem('imgbb_api_key') || '';
const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.addEventListener('DOMContentLoaded', () => {
  checkApiKey();
  checkUrlForAlbum();
  setupDragDrop();
  setupLightboxSwipe();

  document.addEventListener('keydown', (e) => {
    if (!document.getElementById('lightbox').classList.contains('open')) return;
    if (e.key === 'Escape') closeLightbox();
    if (e.key === 'ArrowLeft') lightboxNav(-1);
    if (e.key === 'ArrowRight') lightboxNav(1);
  });
});

function checkApiKey() {
  const status = document.getElementById('api-status');
  if (IMGBB_API_KEY) {
    status.innerHTML = '<span style="color:var(--success)">âœ“ ì„¤ì •ë¨</span>';
    document.getElementById('upload-btn').disabled = selectedFiles.length === 0;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ROUTING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function checkUrlForAlbum() {
  const hash = window.location.hash;
  const match = hash.match(/^#album\/([a-zA-Z0-9_-]+)$/);
  if (match) {
    loadAlbumFromSupabase(match[1]);
  }
}

window.addEventListener('hashchange', () => {
  const hash = window.location.hash;
  if (!hash) { showPage('home'); return; }
  checkUrlForAlbum();
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  FILE HANDLING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setupDragDrop() {
  const zone = document.getElementById('drop-zone');
  const fileInput = document.getElementById('file-input');

  fileInput.addEventListener('change', (e) => handleFiles(e.target.files));
  zone.addEventListener('click', () => fileInput.click());

  zone.addEventListener('dragover', (e) => { e.preventDefault(); zone.classList.add('drag-over'); });
  zone.addEventListener('dragleave', (e) => { if (!zone.contains(e.relatedTarget)) zone.classList.remove('drag-over'); });
  zone.addEventListener('drop', (e) => { e.preventDefault(); zone.classList.remove('drag-over'); handleFiles(e.dataTransfer.files); });
}

function handleFiles(files) {
  const imgs = Array.from(files).filter(f => f.type.startsWith('image/'));
  selectedFiles = [...selectedFiles, ...imgs];
  updatePreview();
}

function updatePreview() {
  const grid = document.getElementById('preview-grid');
  const count = document.getElementById('file-count');
  const btn = document.getElementById('upload-btn');

  count.textContent = selectedFiles.length > 0 ? `${selectedFiles.length}ì¥ ì„ íƒë¨` : 'ì„ íƒëœ íŒŒì¼ ì—†ìŒ';
  btn.disabled = selectedFiles.length === 0 || !IMGBB_API_KEY;

  grid.innerHTML = '';
  selectedFiles.forEach((file, i) => {
    const reader = new FileReader();
    reader.onload = (e) => {
      const item = document.createElement('div');
      item.className = 'preview-item';
      item.innerHTML = `
        <img src="${e.target.result}" alt="">
        <button class="preview-remove" onclick="removeFile(${i})">âœ•</button>
        <div class="preview-name">${file.name}</div>
      `;
      grid.appendChild(item);
    };
    reader.readAsDataURL(file);
  });
}

function removeFile(index) {
  selectedFiles.splice(index, 1);
  updatePreview();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  UPLOAD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function startUpload() {
  if (!IMGBB_API_KEY) { showApiModal(); return; }
  if (selectedFiles.length === 0) return;

  const title = document.getElementById('album-title-input').value.trim() || 'ë‚´ ì•¨ë²”';
  const btn = document.getElementById('upload-btn');
  const progWrap = document.getElementById('progress-bar-wrap');
  const progBar = document.getElementById('progress-bar');
  const progText = document.getElementById('progress-text');

  btn.disabled = true;
  btn.textContent = 'ì—…ë¡œë“œ ì¤‘...';
  progWrap.style.display = 'block';
  progText.style.display = 'block';

  const photos = [];
  const total = selectedFiles.length;

  for (let i = 0; i < total; i++) {
    const file = selectedFiles[i];
    progText.textContent = `ì—…ë¡œë“œ ì¤‘ ${i + 1} / ${total} â€” ${file.name}`;
    progBar.style.width = `${(i / total) * 100}%`;
    try {
      const result = await uploadToImgBB(file);
      photos.push({
        id: result.data.id,
        url: result.data.url,
        display_url: result.data.display_url,
        thumb: result.data.thumb?.url || result.data.url,
        name: file.name,
        size: file.size,
        width: result.data.width,
        height: result.data.height,
      });
    } catch (err) {
      showToast(`âŒ ${file.name} ì‹¤íŒ¨: ${err.message}`, 'error');
    }
  }

  progBar.style.width = '100%';
  progText.textContent = 'ì•¨ë²” ì €ì¥ ì¤‘...';

  try {
    const albumId = generateId();
    const album = { id: albumId, title, photos, created: Date.now() };

    // Supabaseì— ì €ì¥
    await sb.insert('albums', {
      id: albumId,
      title,
      photos: JSON.stringify(photos),
      created_at: new Date().toISOString()
    });

    currentAlbumId = albumId;
    const albumUrl = `${location.origin}${location.pathname}#album/${albumId}`;
    document.getElementById('link-input').value = albumUrl;
    document.getElementById('link-result').style.display = 'block';
    showToast(`âœ“ ${photos.length}ì¥ ì—…ë¡œë“œ ì™„ë£Œ!`, 'success');

  } catch(err) {
    // Supabase ë¯¸ì„¤ì • ì‹œ URL ì¸ì½”ë”© fallback
    console.warn('Supabase ì €ì¥ ì‹¤íŒ¨, URL ë°©ì‹ìœ¼ë¡œ fallback:', err.message);
    const albumId = generateId();
    const album = { id: albumId, title, photos, created: Date.now() };
    const encoded = btoa(unescape(encodeURIComponent(JSON.stringify(album))));
    currentAlbumId = albumId;
    const albumUrl = `${location.origin}${location.pathname}#data/${encoded}`;
    document.getElementById('link-input').value = albumUrl;
    document.getElementById('link-result').style.display = 'block';
    showToast(`âœ“ ${photos.length}ì¥ ì—…ë¡œë“œ ì™„ë£Œ!`, 'success');
  }

  progWrap.style.display = 'none';
  progText.style.display = 'none';
  btn.disabled = false;
  btn.innerHTML = `<svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg> ì•¨ë²” ìƒì„±í•˜ê¸°`;
}

async function uploadToImgBB(file) {
  const formData = new FormData();
  formData.append('image', file);
  const res = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_API_KEY}`, { method: 'POST', body: formData });
  if (!res.ok) { const e = await res.json().catch(() => ({})); throw new Error(e.error?.message || `HTTP ${res.status}`); }
  const data = await res.json();
  if (!data.success) throw new Error(data.error?.message || 'ì—…ë¡œë“œ ì‹¤íŒ¨');
  return data;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ALBUM LOAD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function loadAlbumFromSupabase(albumId) {
  showPage('album');
  document.getElementById('album-loader').style.display = 'block';
  document.getElementById('album-grid').style.display = 'none';
  document.getElementById('album-error').style.display = 'none';

  try {
    const row = await sb.select('albums', albumId);
    if (!row) { showAlbumError(); return; }
    const album = {
      id: row.id,
      title: row.title,
      photos: typeof row.photos === 'string' ? JSON.parse(row.photos) : row.photos,
      created: new Date(row.created_at).getTime()
    };
    document.getElementById('album-loader').style.display = 'none';
    renderAlbum(album);
  } catch(err) {
    // Supabase ë¯¸ì„¤ì • ì‹œ #data/ fallbackë„ ì²´í¬
    document.getElementById('album-loader').style.display = 'none';
    showAlbumError();
  }
}

// #data/ URL fallback (Supabase ë¯¸ì„¤ì • ì‹œ)
function checkDataUrl() {
  const hash = window.location.hash;
  const dataMatch = hash.match(/^#data\/(.+)$/);
  if (dataMatch) {
    try {
      const album = JSON.parse(decodeURIComponent(escape(atob(dataMatch[1]))));
      renderAlbum(album);
    } catch(e) { showAlbumError(); }
    return true;
  }
  return false;
}

// checkUrlForAlbumì— fallback ì¶”ê°€
const _origCheck = checkUrlForAlbum;
window.addEventListener('DOMContentLoaded', () => {
  const hash = window.location.hash;
  if (hash.startsWith('#data/')) checkDataUrl();
});

function showAlbumError() {
  showPage('album');
  document.getElementById('album-loader').style.display = 'none';
  document.getElementById('album-error').style.display = 'block';
  document.getElementById('album-grid').style.display = 'none';
}

function renderAlbum(album) {
  currentAlbumId = album.id;
  currentAlbumPhotos = album.photos;

  document.getElementById('album-display-title').textContent = album.title;
  document.getElementById('album-photo-count').textContent = album.photos.length;
  document.getElementById('album-error').style.display = 'none';

  const grid = document.getElementById('album-grid');
  grid.style.display = '';
  grid.innerHTML = '';

  album.photos.forEach((photo, i) => {
    const card = document.createElement('div');
    card.className = 'photo-card fade-in';
    card.style.animationDelay = `${i * 0.04}s`;
    const escapedUrl = photo.url.replace(/'/g, "\\'");
    const escapedName = photo.name.replace(/'/g, "\\'");
    card.innerHTML = `
      <img src="${photo.display_url || photo.url}" alt="${photo.name}" loading="lazy" onclick="openLightbox(${i})">
      <div class="photo-overlay">
        <button class="photo-overlay-btn" onclick="openLightbox(${i})">
          <svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 6s4-6 11-6 11 6 11 6-4 6-11 6-11-6-11-6z"/><circle cx="12" cy="6" r="2"/></svg>í¬ê²Œ ë³´ê¸°
        </button>
        <button class="photo-overlay-btn" onclick="downloadPhoto('${escapedUrl}','${escapedName}')">
          <svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>ë‹¤ìš´ë¡œë“œ
        </button>
      </div>
      <div class="photo-mobile-bar">
        <button class="photo-overlay-btn" onclick="openLightbox(${i})">
          <svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 6s4-6 11-6 11 6 11 6-4 6-11 6-11-6-11-6z"/><circle cx="12" cy="6" r="2"/></svg>ë³´ê¸°
        </button>
        <button class="photo-overlay-btn" onclick="downloadPhoto('${escapedUrl}','${escapedName}')">
          <svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>ì €ì¥
        </button>
      </div>
    `;
    grid.appendChild(card);
  });

  showPage('album');
}

function goToCurrentAlbum() {
  const url = document.getElementById('link-input').value;
  const hash = new URL(url).hash;
  window.location.hash = hash;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  LIGHTBOX
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openLightbox(index) {
  lightboxIndex = index;
  updateLightbox();
  document.getElementById('lightbox').classList.add('open');
  document.body.style.overflow = 'hidden';
}

function closeLightbox() {
  document.getElementById('lightbox').classList.remove('open');
  document.body.style.overflow = '';
}

function lightboxNav(dir) {
  lightboxIndex = (lightboxIndex + dir + currentAlbumPhotos.length) % currentAlbumPhotos.length;
  updateLightbox();
}

function updateLightbox() {
  const photo = currentAlbumPhotos[lightboxIndex];
  document.getElementById('lightbox-img').src = photo.url;
  document.getElementById('lightbox-name').textContent = `${photo.name} (${lightboxIndex + 1}/${currentAlbumPhotos.length})`;
}

function downloadCurrent() {
  const photo = currentAlbumPhotos[lightboxIndex];
  downloadPhoto(photo.url, photo.name);
}

// ìŠ¤ì™€ì´í”„ ì§€ì›
function setupLightboxSwipe() {
  const lb = document.getElementById('lightbox');
  let startX = 0;
  lb.addEventListener('touchstart', (e) => { startX = e.touches[0].clientX; }, { passive: true });
  lb.addEventListener('touchend', (e) => {
    const diff = startX - e.changedTouches[0].clientX;
    if (Math.abs(diff) > 50) lightboxNav(diff > 0 ? 1 : -1);
  }, { passive: true });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  DOWNLOAD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function downloadPhoto(url, name) {
  if (isMobile) {
    // ëª¨ë°”ì¼: ìƒˆ íƒ­ìœ¼ë¡œ ì—´ê³  ì•ˆë‚´
    window.open(url, '_blank');
    showToast('ğŸ“± ì‚¬ì§„ì„ ê¸¸ê²Œ ëˆŒëŸ¬ì„œ ì €ì¥í•˜ì„¸ìš”', '');
    return;
  }
  try {
    showToast('ğŸ“¥ ë‹¤ìš´ë¡œë“œ ì¤‘...', '');
    const res = await fetch(url, { mode: 'cors' });
    if (!res.ok) throw new Error('fetch ì‹¤íŒ¨');
    const blob = await res.blob();
    const blobUrl = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = blobUrl;
    a.download = name;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    setTimeout(() => URL.revokeObjectURL(blobUrl), 2000);
  } catch(e) {
    window.open(url, '_blank');
  }
}

function downloadAll() {
  if (currentAlbumPhotos.length === 0) return;
  if (isMobile) {
    showToast('ğŸ“± ê° ì‚¬ì§„ â†’ ê¸¸ê²Œ ëˆŒëŸ¬ì„œ ì €ì¥í•˜ì„¸ìš”', '');
    return;
  }
  showToast('ğŸ“¥ ì „ì²´ ë‹¤ìš´ë¡œë“œë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...', 'success');
  currentAlbumPhotos.forEach((photo, i) => {
    setTimeout(() => downloadPhoto(photo.url, photo.name), i * 700);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SHARE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function shareAlbum() {
  const url = window.location.href;
  if (navigator.share && isMobile) {
    navigator.share({ title: 'ì‚¬ì§„ ì•¨ë²”', url }).catch(() => {});
    return;
  }
  copyToClipboard(url);
  showToast('âœ“ ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
}

function copyLink() {
  const url = document.getElementById('link-input').value;
  copyToClipboard(url);
  const btn = document.getElementById('copy-btn');
  btn.textContent = 'âœ“ ë³µì‚¬ë¨';
  btn.classList.add('copied');
  setTimeout(() => { btn.textContent = 'ë³µì‚¬'; btn.classList.remove('copied'); }, 2000);
}

function copyToClipboard(text) {
  if (navigator.clipboard) { navigator.clipboard.writeText(text).catch(() => {}); return; }
  const ta = document.createElement('textarea');
  ta.value = text;
  ta.style.position = 'fixed';
  ta.style.opacity = '0';
  document.body.appendChild(ta);
  ta.focus(); ta.select();
  document.execCommand('copy');
  document.body.removeChild(ta);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  API KEY MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showApiModal() {
  document.getElementById('api-key-input').value = IMGBB_API_KEY;
  document.getElementById('api-modal').classList.add('open');
}
function closeApiModal() { document.getElementById('api-modal').classList.remove('open'); }
function saveApiKey() {
  const key = document.getElementById('api-key-input').value.trim();
  if (!key) { showToast('API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”', 'error'); return; }
  IMGBB_API_KEY = key;
  localStorage.setItem('imgbb_api_key', key);
  closeApiModal();
  checkApiKey();
  updatePreview();
  showToast('âœ“ API í‚¤ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showPage(page) {
  document.getElementById('page-home').style.display = page === 'home' ? 'block' : 'none';
  document.getElementById('page-album').style.display = page === 'album' ? 'block' : 'none';
}

function showHome() {
  history.pushState('', document.title, window.location.pathname);
  showPage('home');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  TOAST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showToast(msg, type = '') {
  const toast = document.getElementById('toast');
  toast.textContent = msg;
  toast.className = type;
  toast.classList.add('show');
  clearTimeout(toast._t);
  toast._t = setTimeout(() => toast.classList.remove('show'), 3000);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  UTILS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function generateId() {
  return Math.random().toString(36).slice(2, 9) + Date.now().toString(36).slice(-4);
}
</script>
</body>
</html>
